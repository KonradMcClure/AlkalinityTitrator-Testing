clear variables, close all, clc, format compact

temp=[

22.724575907372596
22.758379217617108
22.825986858042803
22.893595858453402
22.96120621892964
22.96120621892964
23.062624309948838
23.130238070950185
23.19785319230591
23.299278425182035
23.40070671931604
23.40070671931604
23.502138074985034
23.603572492466494
23.63738464541098
23.772636659716103
23.874079243385797
23.907894118557486
24.009340786061372
24.11079051676438
24.178425372480806
24.27988020913247
24.415158090843303
24.48279907453086
24.618085127980663
24.685730197907745
24.821024424577047
24.888673581484102
24.99014987154172
25.05780243483177
25.193111649585124
25.260768301213638
25.429915893346184
25.497577315639607
25.632904250007513
25.734403029665355
25.80207058715492
25.937409793026536
26.072754453971175
26.140428830302767
26.241942952354794
26.34346014372065
26.478821173844555
26.5803455280252
26.68187295244825
26.817247628092503
26.95262776310078
27.054166447461462
27.088013358132795
27.25725303108875
27.392650913591442
27.52805425826638
27.629610351720107
27.731169518296927
27.866586521293872
28.035865459551996
28.103579425857657
28.20515293736229
28.306729523571537
28.44216975520596
28.543753516810497
28.679203316652817
28.84852325655228
28.950119322373205
29.051718464947374
29.187188774922863
29.32266455584071
29.424274982233875
29.492016976510666
29.661377947859428
29.79687288229736
29.932373290661605
29.96624924813158
30.203390531824432
30.27114826435593
30.406667836689152
30.54219288593564
30.609957464608904
30.745490730470387
30.84714427514464
31.01657369857963
31.118235462484858
31.253789276424516
31.35545823379244
31.49102164003425
31.62659052850577
31.762164899871966
31.796059349493817
31.965536738804907
32.06722728572717
32.168920917994434
32.236718387058595
32.37231743968742
32.44011902341842
32.57572630613038
32.64353200527767
32.71133907639711
32.77914751957205
32.846957334885104
32.948674630796916
33.016487876821145
33.08430249527561
33.15211848624328
33.25384504633993
33.28775458605283
33.35557469506104
33.38948526437738
33.457307432687465
33.49121903170149
33.592955888306406
33.592955888306406
33.69469583447336
33.69469583447336
33.76252418181402
33.76252418181402
33.83035390250147
33.86426927787671
33.89818499661981
33.93210105874166
33.966017464252396
33.99993421316253
33.99993421316253
34.06776874122269
34.10168652039336
34.135604643005486
34.16952310906883
34.16952310906883
34.16952310906883
34.20344191859428
34.237361071592346
34.27128056807317
34.3052004080469
34.3052004080469
34.3052004080469
34.37304111851659
34.37304111851659
34.37304111851659
34.44088320308477
34.37304111851659
34.406961989033206
34.406961989033206
34.474804760681806
34.474804760681806
34.50872666183444
34.50872666183444
34.50872666183444
34.542648906553936
34.542648906553936
34.542648906553936
34.57657149485006
34.610494426733325
34.610494426733325
34.610494426733325
34.64441770221425
34.64441770221425
34.67834132130334
34.67834132130334
34.67834132130334
34.67834132130334
34.71226528401074
34.71226528401074
34.71226528401074
34.71226528401074
34.746189590347704
34.78011424032326
34.71226528401074
34.81403923394941
34.746189590347704
34.78011424032326
34.81403923394941
34.81403923394941
34.81403923394941
34.81403923394941
34.84796457123554
34.84796457123554
34.84796457123554
34.81403923394941
34.881890252192555
34.81403923394941
34.881890252192555
34.881890252192555
34.881890252192555
34.881890252192555
34.881890252192555
34.84796457123554
34.84796457123554
34.881890252192555
34.84796457123554
34.881890252192555
34.84796457123554
34.84796457123554
34.84796457123554
34.84796457123554
34.881890252192555
34.881890252192555
34.881890252192555
34.881890252192555
34.881890252192555
34.915816276830576
34.983669357192454
34.915816276830576
34.881890252192555
34.915816276830576
34.915816276830576
34.94974264516049
34.915816276830576
34.915816276830576
34.94974264516049
34.983669357192454
34.94974264516049
34.915816276830576
34.915816276830576
34.915816276830576
34.983669357192454
34.915816276830576
34.915816276830576
34.915816276830576
34.94974264516049
34.915816276830576
34.915816276830576
34.915816276830576
34.915816276830576
34.915816276830576
34.915816276830576
34.94974264516049
34.94974264516049
34.94974264516049
34.94974264516049
34.983669357192454
34.94974264516049
34.915816276830576
34.94974264516049
34.94974264516049
34.94974264516049
34.94974264516049
34.983669357192454
34.983669357192454

];
time=linspace(0, length(temp), length(temp))';
plot(time, temp)
hold on
tau=50.428
kp=.1
ki=.000001
kd=3
tempnewton=(16.5*time)/(50.0712 + 95)+22;
PID=pid(kp, ki, kd, temp,1);
%tempnewton=min(temp)*exp((-time+25)/tau)+(max(340)+.15)*(1-exp((-time+25)/tau))
%syst=tfest(temp,1)
syms s
s = tf('s');
To = 22.7;            % ambient/initial temperature
K = 12.8;             % DC gain
tau = 35; 
%syms s% time constant
P = K/(tau*s+1);      % model transfer function
[y,t] = step(P,237);  % model step response
step(P+22,0:1:237);

P = K/(tau*s+1);
sym x
% plot(temp,'b:')
% xlabel('time (sec)')
% ylabel('temperature (degrees C)')
% title('Lightbulb Temperature Step Response')
legend('model','experiment','Location','SouthEast')
%feedback(P,PID)
%step(P*PID)
T=(175*exp(t/35))/64
plot(time,(64*exp(-t/35))/175)